{"ast":null,"code":"import _slicedToArray from\"/Users/funglam/Desktop/HRManagementSystem/ManagementSystemFE_2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{EditOutlined,DeleteOutlined,DownOutlined}from\"@ant-design/icons\";import{useState,useEffect,createContext,useContext,useRef}from\"react\";import{Table,Button,Select}from\"antd\";import AlertModal from\"../modal/alertModal\";import EditFormModal from\"../modal/editFormModal\";import{getAllEmployees}from\"../../api/employee\";import{InitContext}from\"../../Layout/appLayout\";import{getLabelMap,STATUS_WITHIN_A_MONTH,STATUS_WITHIN_3_MONTH,SELECT_ALL,SELCT_WITHIN_A_MONTH,SELECT_WITHIN_3_MONTHS}from\"../../common\";import\"./index.css\";import NewFormModal from\"../modal/newFormModal\";import moment from\"moment\";import{dateFormat}from\"../../common/dateHelper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var AppContext=/*#__PURE__*/createContext(null);var EmployeeTable=function EmployeeTable(){var _useContext=useContext(InitContext),fieldLabel=_useContext.fieldLabel;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),alertVisible=_useState2[0],setAlertVisible=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),editFormVisible=_useState4[0],setEditFormVisible=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),newFormVisible=_useState6[0],setNewFormVisible=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),employees=_useState8[0],setEmployees=_useState8[1];var _useState9=useState(new Map()),_useState10=_slicedToArray(_useState9,2),labelMap=_useState10[0],setLabelMap=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),initFormVal=_useState12[0],setInitFormVal=_useState12[1];var _useState13=useState(SELECT_ALL),_useState14=_slicedToArray(_useState13,2),filterOption=_useState14[0],setFilterOption=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),tableDate=_useState16[0],setTableData=_useState16[1];var selectRef=useRef(null);var iniEmployees=function iniEmployees(){getAllEmployees().then(function(rsp){setEmployees(rsp.data);if(filterOption===SELECT_ALL){setTableData(rsp.data);}});};useEffect(function(){iniEmployees();},[]);useEffect(function(){if(fieldLabel){var _labelMap=getLabelMap(fieldLabel,\"HOME\");setLabelMap(_labelMap);}},[fieldLabel]);var Option=Select.Option;var columns=[{title:\"\".concat(labelMap&&labelMap.get(\"H5\")?labelMap.get(\"H5\"):\"Name\"),dataIndex:\"name\",editable:true,inputType:\"text\",render:function render(_,record){if(record.status===STATUS_WITHIN_A_MONTH){return/*#__PURE__*/_jsx(\"span\",{className:\"m1Alert\",children:record.name});}else if(record.status===STATUS_WITHIN_3_MONTH){return/*#__PURE__*/_jsx(\"span\",{className:\"m3Alert\",children:record.name});}else{return/*#__PURE__*/_jsx(\"span\",{children:record.name});}}},{title:\"\".concat(labelMap&&labelMap.get(\"H6\")?labelMap.get(\"H6\"):\"Contact No.\"),dataIndex:\"contact\",editable:true,inputType:\"text\",render:function render(_,record){if(record.status===STATUS_WITHIN_A_MONTH){return/*#__PURE__*/_jsx(\"span\",{className:\"m1Alert\",children:record.contact});}else if(record.status===STATUS_WITHIN_3_MONTH){return/*#__PURE__*/_jsx(\"span\",{className:\"m3Alert\",children:record.contact});}else{return/*#__PURE__*/_jsx(\"span\",{children:record.contact});}}},{title:\"\".concat(labelMap&&labelMap.get(\"H7\")?labelMap.get(\"H7\"):\"Building\"),dataIndex:\"building\",editable:true,inputType:\"text\",render:function render(_,record){if(record.status===STATUS_WITHIN_A_MONTH){return/*#__PURE__*/_jsx(\"span\",{className:\"m1Alert\",children:record.building});}else if(record.status===STATUS_WITHIN_3_MONTH){return/*#__PURE__*/_jsx(\"span\",{className:\"m3Alert\",children:record.building});}else{return/*#__PURE__*/_jsx(\"span\",{children:record.building});}}},{title:\"\".concat(labelMap&&labelMap.get(\"H8\")?labelMap.get(\"H8\"):\"Employment Date\"),dataIndex:\"employmentDate\",editable:true,inputType:\"date\",render:function render(_,record){if(record.status===STATUS_WITHIN_A_MONTH){return/*#__PURE__*/_jsx(\"span\",{className:\"m1Alert\",children:record.employmentDate});}else if(record.status===STATUS_WITHIN_3_MONTH){return/*#__PURE__*/_jsx(\"span\",{className:\"m3Alert\",children:record.employmentDate});}else{return/*#__PURE__*/_jsx(\"span\",{children:record.employmentDate});}}},{title:\"\".concat(labelMap&&labelMap.get(\"H9\")?labelMap.get(\"H9\"):\"Contract Expiry Date\"),dataIndex:\"expiryDate\",editable:true,inputType:\"date\",render:function render(_,record){if(record.status===STATUS_WITHIN_A_MONTH){return/*#__PURE__*/_jsx(\"span\",{className:\"m1Alert\",children:record.expiryDate});}else if(record.status===STATUS_WITHIN_3_MONTH){return/*#__PURE__*/_jsx(\"span\",{className:\"m3Alert\",children:record.expiryDate});}else{return/*#__PURE__*/_jsx(\"span\",{children:record.expiryDate});}}},{title:\"\".concat(labelMap&&labelMap.get(\"H10\")?labelMap.get(\"H10\"):\"Tools\"),dataIndex:\"action\",render:function render(_,record){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{className:\"editButton\",shape:\"circle\",icon:/*#__PURE__*/_jsx(EditOutlined,{}),size:\"large\",onClick:function onClick(){return editEmpoyee(record);}}),/*#__PURE__*/_jsx(Button,{className:\"deleteButton\",shape:\"circle\",icon:/*#__PURE__*/_jsx(DeleteOutlined,{}),size:\"large\",onClick:function onClick(){return removeEmpoyee(record);}})]});}}];var addEmployee=function addEmployee(){setNewFormVisible(true);};var editEmpoyee=function editEmpoyee(record){var startDate=null;var endDate=null;if(record.employmentDate){startDate=moment(record.employmentDate,dateFormat);}if(record.expiryDate){endDate=moment(record.expiryDate,dateFormat);}var iniVal={id:record.id,name:record.name,contact:record.contact,building:record.building,contactPeriod:[startDate,endDate]};setInitFormVal(iniVal);setEditFormVisible(true);};var removeEmpoyee=function removeEmpoyee(record){setInitFormVal(record);setAlertVisible(true);};var handleSelectChange=function handleSelectChange(val){console.log(val);if(val===SELECT_ALL){setTableData(employees);}else if(val===SELCT_WITHIN_A_MONTH){var filteredEmps=employees.filter(function(emp){return emp.status===STATUS_WITHIN_A_MONTH;});setTableData(filteredEmps);}else if(val===SELECT_WITHIN_3_MONTHS){var _filteredEmps=employees.filter(function(emp){return emp.status===STATUS_WITHIN_3_MONTH;});setTableData(_filteredEmps);}};return/*#__PURE__*/_jsx(\"div\",{className:\"main-container\",children:/*#__PURE__*/_jsxs(AppContext.Provider,{value:{initForm:[initFormVal,setInitFormVal],alert:[alertVisible,setAlertVisible],editForm:[editFormVisible,setEditFormVisible],newForm:[newFormVisible,setNewFormVisible],iniEmployees:iniEmployees},children:[/*#__PURE__*/_jsx(Button,{shape:\"circle\",className:\"newButton\",onClick:addEmployee,children:\"+\"}),/*#__PURE__*/_jsxs(Select,{ref:selectRef,defaultValue:SELECT_ALL,style:{width:200},className:\"filter-selector\",onChange:handleSelectChange,children:[/*#__PURE__*/_jsx(Option,{value:SELECT_ALL,children:labelMap&&labelMap.get(\"H11\")?labelMap.get(\"H11\"):\"Show All\"}),/*#__PURE__*/_jsx(Option,{value:SELCT_WITHIN_A_MONTH,children:labelMap&&labelMap.get(\"H12\")?labelMap.get(\"H12\"):\"Expire within 1 Month\"}),/*#__PURE__*/_jsx(Option,{value:SELECT_WITHIN_3_MONTHS,children:labelMap&&labelMap.get(\"H13\")?labelMap.get(\"H13\"):\"Expire within 3 Months\"})]}),/*#__PURE__*/_jsx(Table,{columns:columns,dataSource:tableDate}),/*#__PURE__*/_jsx(AlertModal,{}),/*#__PURE__*/_jsx(EditFormModal,{}),/*#__PURE__*/_jsx(NewFormModal,{})]})});};export default EmployeeTable;","map":{"version":3,"sources":["/Users/funglam/Desktop/HRManagementSystem/ManagementSystemFE_2/src/components/employeeTable/index.jsx"],"names":["EditOutlined","DeleteOutlined","DownOutlined","useState","useEffect","createContext","useContext","useRef","Table","Button","Select","AlertModal","EditFormModal","getAllEmployees","InitContext","getLabelMap","STATUS_WITHIN_A_MONTH","STATUS_WITHIN_3_MONTH","SELECT_ALL","SELCT_WITHIN_A_MONTH","SELECT_WITHIN_3_MONTHS","NewFormModal","moment","dateFormat","AppContext","EmployeeTable","fieldLabel","alertVisible","setAlertVisible","editFormVisible","setEditFormVisible","newFormVisible","setNewFormVisible","employees","setEmployees","Map","labelMap","setLabelMap","initFormVal","setInitFormVal","filterOption","setFilterOption","tableDate","setTableData","selectRef","iniEmployees","then","rsp","data","Option","columns","title","get","dataIndex","editable","inputType","render","_","record","status","name","contact","building","employmentDate","expiryDate","editEmpoyee","removeEmpoyee","addEmployee","startDate","endDate","iniVal","id","contactPeriod","handleSelectChange","val","console","log","filteredEmps","filter","emp","initForm","alert","editForm","newForm","width"],"mappings":"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","sourcesContent":["import { EditOutlined, DeleteOutlined, DownOutlined } from \"@ant-design/icons\";\nimport { useState, useEffect, createContext, useContext, useRef } from \"react\";\nimport { Table, Button, Select } from \"antd\";\nimport AlertModal from \"../modal/alertModal\";\nimport EditFormModal from \"../modal/editFormModal\";\nimport { getAllEmployees } from \"../../api/employee\";\nimport { InitContext } from \"../../Layout/appLayout\";\nimport {\n  getLabelMap,\n  STATUS_WITHIN_A_MONTH,\n  STATUS_WITHIN_3_MONTH,\n  SELECT_ALL,\n  SELCT_WITHIN_A_MONTH,\n  SELECT_WITHIN_3_MONTHS,\n} from \"../../common\";\nimport \"./index.css\";\nimport NewFormModal from \"../modal/newFormModal\";\nimport moment from \"moment\";\nimport { dateFormat } from \"../../common/dateHelper\";\nexport const AppContext = createContext(null);\nconst EmployeeTable = () => {\n  const { fieldLabel } = useContext(InitContext);\n  const [alertVisible, setAlertVisible] = useState(false);\n  const [editFormVisible, setEditFormVisible] = useState(false);\n  const [newFormVisible, setNewFormVisible] = useState(false);\n\n  const [employees, setEmployees] = useState([]);\n  const [labelMap, setLabelMap] = useState(new Map());\n  const [initFormVal, setInitFormVal] = useState(null);\n  const [filterOption, setFilterOption] = useState(SELECT_ALL);\n  const [tableDate, setTableData] = useState(null);\n\n  const selectRef = useRef(null);\n\n  const iniEmployees = () => {\n    getAllEmployees().then((rsp) => {\n      setEmployees(rsp.data);\n      if (filterOption === SELECT_ALL) {\n        setTableData(rsp.data);\n      }\n    });\n  };\n\n  useEffect(() => {\n    iniEmployees();\n  }, []);\n\n  useEffect(() => {\n    if (fieldLabel) {\n      let labelMap = getLabelMap(fieldLabel, \"HOME\");\n      setLabelMap(labelMap);\n    }\n  }, [fieldLabel]);\n\n  const { Option } = Select;\n\n  const columns = [\n    {\n      title: `${labelMap && labelMap.get(\"H5\") ? labelMap.get(\"H5\") : \"Name\"}`,\n      dataIndex: \"name\",\n      editable: true,\n      inputType: \"text\",\n      render: (_, record) => {\n        if (record.status === STATUS_WITHIN_A_MONTH) {\n          return <span className=\"m1Alert\">{record.name}</span>;\n        } else if (record.status === STATUS_WITHIN_3_MONTH) {\n          return <span className=\"m3Alert\">{record.name}</span>;\n        } else {\n          return <span>{record.name}</span>;\n        }\n      },\n    },\n    {\n      title: `${\n        labelMap && labelMap.get(\"H6\") ? labelMap.get(\"H6\") : \"Contact No.\"\n      }`,\n      dataIndex: \"contact\",\n      editable: true,\n      inputType: \"text\",\n      render: (_, record) => {\n        if (record.status === STATUS_WITHIN_A_MONTH) {\n          return <span className=\"m1Alert\">{record.contact}</span>;\n        } else if (record.status === STATUS_WITHIN_3_MONTH) {\n          return <span className=\"m3Alert\">{record.contact}</span>;\n        } else {\n          return <span>{record.contact}</span>;\n        }\n      },\n    },\n    {\n      title: `${\n        labelMap && labelMap.get(\"H7\") ? labelMap.get(\"H7\") : \"Building\"\n      }`,\n      dataIndex: \"building\",\n      editable: true,\n      inputType: \"text\",\n      render: (_, record) => {\n        if (record.status === STATUS_WITHIN_A_MONTH) {\n          return <span className=\"m1Alert\">{record.building}</span>;\n        } else if (record.status === STATUS_WITHIN_3_MONTH) {\n          return <span className=\"m3Alert\">{record.building}</span>;\n        } else {\n          return <span>{record.building}</span>;\n        }\n      },\n    },\n    {\n      title: `${\n        labelMap && labelMap.get(\"H8\") ? labelMap.get(\"H8\") : \"Employment Date\"\n      }`,\n      dataIndex: \"employmentDate\",\n      editable: true,\n      inputType: \"date\",\n      render: (_, record) => {\n        if (record.status === STATUS_WITHIN_A_MONTH) {\n          return <span className=\"m1Alert\">{record.employmentDate}</span>;\n        } else if (record.status === STATUS_WITHIN_3_MONTH) {\n          return <span className=\"m3Alert\">{record.employmentDate}</span>;\n        } else {\n          return <span>{record.employmentDate}</span>;\n        }\n      },\n    },\n    {\n      title: `${\n        labelMap && labelMap.get(\"H9\")\n          ? labelMap.get(\"H9\")\n          : \"Contract Expiry Date\"\n      }`,\n      dataIndex: \"expiryDate\",\n      editable: true,\n      inputType: \"date\",\n      render: (_, record) => {\n        if (record.status === STATUS_WITHIN_A_MONTH) {\n          return <span className=\"m1Alert\">{record.expiryDate}</span>;\n        } else if (record.status === STATUS_WITHIN_3_MONTH) {\n          return <span className=\"m3Alert\">{record.expiryDate}</span>;\n        } else {\n          return <span>{record.expiryDate}</span>;\n        }\n      },\n    },\n    {\n      title: `${\n        labelMap && labelMap.get(\"H10\") ? labelMap.get(\"H10\") : \"Tools\"\n      }`,\n      dataIndex: \"action\",\n      render: (_, record) => {\n        return (\n          <>\n            <Button\n              className=\"editButton\"\n              shape=\"circle\"\n              icon={<EditOutlined />}\n              size=\"large\"\n              onClick={() => editEmpoyee(record)}\n            ></Button>\n            <Button\n              className=\"deleteButton\"\n              shape=\"circle\"\n              icon={<DeleteOutlined />}\n              size=\"large\"\n              onClick={() => removeEmpoyee(record)}\n            ></Button>\n          </>\n        );\n      },\n    },\n  ];\n\n  const addEmployee = () => {\n    setNewFormVisible(true);\n  };\n\n  const editEmpoyee = (record) => {\n    let startDate = null;\n    let endDate = null;\n\n    if (record.employmentDate) {\n      startDate = moment(record.employmentDate, dateFormat);\n    }\n    if (record.expiryDate) {\n      endDate = moment(record.expiryDate, dateFormat);\n    }\n    let iniVal = {\n      id: record.id,\n      name: record.name,\n      contact: record.contact,\n      building: record.building,\n      contactPeriod: [startDate, endDate],\n    };\n    setInitFormVal(iniVal);\n    setEditFormVisible(true);\n  };\n\n  const removeEmpoyee = (record) => {\n    setInitFormVal(record);\n    setAlertVisible(true);\n  };\n\n  const handleSelectChange = (val) => {\n    console.log(val);\n    if (val === SELECT_ALL) {\n      setTableData(employees);\n    } else if (val === SELCT_WITHIN_A_MONTH) {\n      let filteredEmps = employees.filter(\n        (emp) => emp.status === STATUS_WITHIN_A_MONTH\n      );\n      setTableData(filteredEmps);\n    } else if (val === SELECT_WITHIN_3_MONTHS) {\n      let filteredEmps = employees.filter(\n        (emp) => emp.status === STATUS_WITHIN_3_MONTH\n      );\n      setTableData(filteredEmps);\n    }\n  };\n\n  return (\n    <div className=\"main-container\">\n      <AppContext.Provider\n        value={{\n          initForm: [initFormVal, setInitFormVal],\n          alert: [alertVisible, setAlertVisible],\n          editForm: [editFormVisible, setEditFormVisible],\n          newForm: [newFormVisible, setNewFormVisible],\n          iniEmployees: iniEmployees,\n        }}\n      >\n        <Button shape=\"circle\" className=\"newButton\" onClick={addEmployee}>\n          +\n        </Button>\n        <Select\n          ref={selectRef}\n          defaultValue={SELECT_ALL}\n          style={{ width: 200 }}\n          className=\"filter-selector\"\n          onChange={handleSelectChange}\n        >\n          <Option value={SELECT_ALL}>\n            {labelMap && labelMap.get(\"H11\") ? labelMap.get(\"H11\") : \"Show All\"}\n          </Option>\n          <Option value={SELCT_WITHIN_A_MONTH}>\n            {labelMap && labelMap.get(\"H12\")\n              ? labelMap.get(\"H12\")\n              : \"Expire within 1 Month\"}\n          </Option>\n          <Option value={SELECT_WITHIN_3_MONTHS}>\n            {labelMap && labelMap.get(\"H13\")\n              ? labelMap.get(\"H13\")\n              : \"Expire within 3 Months\"}\n          </Option>\n        </Select>\n        <Table columns={columns} dataSource={tableDate} />\n        <AlertModal />\n        <EditFormModal />\n        <NewFormModal />\n      </AppContext.Provider>\n    </div>\n  );\n};\n\nexport default EmployeeTable;\n"]},"metadata":{},"sourceType":"module"}